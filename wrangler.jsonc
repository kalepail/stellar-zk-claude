{
  "$schema": "node_modules/wrangler/config-schema.json",
  "name": "stellar-zk",
  "main": "./worker/index.ts",
  "compatibility_date": "2025-04-01",
  "compatibility_flags": ["nodejs_compat"],
  "assets": {
    "not_found_handling": "single-page-application",
    "binding": "ASSETS"
  },
  "vars": {
    "PROVER_BASE_URL": "https://replace-with-your-prover.example.com",
    "PROVER_HEALTH_CACHE_MS": "30000",
    "PROVER_POLL_INTERVAL_MS": "3000",
    "PROVER_POLL_TIMEOUT_MS": "660000",
    "PROVER_POLL_BUDGET_MS": "45000",
    "PROVER_REQUEST_TIMEOUT_MS": "30000",
    "MAX_TAPE_BYTES": "2097152",
    "MAX_JOB_WALL_TIME_MS": "660000",
    "MAX_COMPLETED_JOBS": "200",
    "COMPLETED_JOB_RETENTION_MS": "86400000",
    "ALLOW_INSECURE_PROVER_URL": "0",
    "CLAIM_RELAY_URL": "https://replace-with-your-claim-relay.example.com/submit",
    "CLAIM_RELAY_REQUEST_TIMEOUT_MS": "30000",
    "SCORE_CONTRACT_ID": "replace-with-your-score-contract-id",
    "GALEXIE_API_BASE_URL": "https://galexie-pro.lightsail.network",
    "GALEXIE_SOURCE_MODE": "auto",
    "GALEXIE_RPC_BASE_URL": "https://rpc-pro.lightsail.network",
    "GALEXIE_SCORE_EVENTS_PATH": "/events",
    "GALEXIE_DATASTORE_ROOT_PATH": "/v1",
    "GALEXIE_DATASTORE_OBJECT_EXTENSION": "zst",
    "GALEXIE_REQUEST_TIMEOUT_MS": "20000",
    "LEADERBOARD_SYNC_CRON_ENABLED": "1",
    "LEADERBOARD_SYNC_CRON_LIMIT": "400",
    "LEADERBOARD_CATCHUP_INTERVAL_MINUTES": "30",
    "LEADERBOARD_CATCHUP_WINDOW_LEDGERS": "8000",
    "LEADERBOARD_FORWARD_REPLAY_WINDOW_LEDGERS": "8000"
  },
  "r2_buckets": [
    {
      "binding": "PROOF_ARTIFACTS",
      "bucket_name": "stellar-zk-proof-artifacts"
    }
  ],
  "d1_databases": [
    {
      "binding": "LEADERBOARD_DB",
      "database_name": "stellar-zk-leaderboard",
      "database_id": "replace-with-your-d1-database-id"
    }
  ],
  "queues": {
    "producers": [
      {
        "binding": "PROOF_QUEUE",
        "queue": "stellar-zk-proof-jobs"
      },
      {
        "binding": "CLAIM_QUEUE",
        "queue": "stellar-zk-claim-jobs"
      }
    ],
    "consumers": [
      {
        "queue": "stellar-zk-proof-jobs",
        "max_batch_size": 1,
        "max_batch_timeout": 1,
        "max_retries": 10,
        "max_concurrency": 1,
        "dead_letter_queue": "stellar-zk-proof-jobs-dlq"
      },
      {
        "queue": "stellar-zk-proof-jobs-dlq",
        "max_batch_size": 1,
        "max_batch_timeout": 5,
        "max_retries": 3,
        "max_concurrency": 1
      },
      {
        "queue": "stellar-zk-claim-jobs",
        "max_batch_size": 1,
        "max_batch_timeout": 1,
        "max_retries": 10,
        "max_concurrency": 1,
        "dead_letter_queue": "stellar-zk-claim-jobs-dlq"
      },
      {
        "queue": "stellar-zk-claim-jobs-dlq",
        "max_batch_size": 1,
        "max_batch_timeout": 5,
        "max_retries": 3,
        "max_concurrency": 1
      }
    ]
  },
  "durable_objects": {
    "bindings": [
      {
        "name": "PROOF_COORDINATOR",
        "class_name": "ProofCoordinatorDO"
      }
    ]
  },
  "migrations": [
    {
      "tag": "v1-proof-coordinator",
      "new_sqlite_classes": [
        "ProofCoordinatorDO"
      ]
    }
  ],
  "triggers": {
    "crons": ["*/5 * * * *"]
  }
}
